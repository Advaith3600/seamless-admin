import{f as i,q as $,G as j,c as l,a as t,t as u,b as v,A as B,T as D,w as k,o as r,_ as y,l as E,v as N,F as S,d as T,e as w,E as U}from"./VueFeather-LP1Aqx4j.js";const V=["name","value"],A={key:0,class:"absolute top-full left-0 w-full bg-white mt-1 rounded shadow"},F=["placeholder"],L={class:"overflow-auto max-h-48"},q=["onClick"],M={class:"mr-2"},O={key:0,class:"p-2 text-center"},z={__name:"ForeignSelection",props:["type","field","default","column_name","api_endpoint","referenced_table_name","referenced_column_name"],setup(d){const s=d,c=i(!1),p=i(s.default),o=i(""),_=i(null),m=$([]),b={credentials:"same-origin",headers:{Accept:"application/json"}},g=a=>{const e=[];for(const n of Object.keys(a))e.push(`${n}=${a[n]}`);return encodeURI(e.join("&"))},f=()=>{const a={search:o.value,referenced_table_name:s.referenced_table_name,referenced_column_name:s.referenced_column_name};fetch(`${s.api_endpoint}?${g(a)}`,b).then(e=>e.json()).then(e=>m.values=e)},C=()=>{c.value=!0,setTimeout(()=>_.value.focus())};f();const x=a=>{p.value=a.key,o.value="",c.value=!1},h=()=>{c.value=!1,o.value=""};return document.addEventListener("click",h),j(()=>document.removeEventListener("click",h)),(a,e)=>(r(),l("div",{class:"relative",onClick:e[1]||(e[1]=k(()=>{},["stop"]))},[t("input",{type:"hidden",name:d.field,value:p.value},null,8,V),t("div",{class:"input flex justify-between items-center cursor-default",onClick:C},[t("div",null,u(p.value||"Selection"),1),v(y,{type:"chevron-down",size:"16",strokeWidth:"3"})]),v(D,{name:"fade"},{default:B(()=>[c.value?(r(),l("div",A,[t("form",{class:"p-1 search",onSubmit:k(f,["prevent"])},[E(t("input",{ref_key:"search_elem",ref:_,type:"text",class:"input w-full","onUpdate:modelValue":e[0]||(e[0]=n=>o.value=n),placeholder:`search ${d.referenced_table_name}...`},null,8,F),[[N,o.value]]),t("div",{class:"icon",onClick:f},[v(y,{type:"search"})])],32),t("div",L,[(r(!0),l(S,null,T(m.values,n=>(r(),l("div",{class:"p-2 hover:bg-gray-200 transition cursor-pointer",onClick:G=>x(n)},[t("span",M,u(s.referenced_column_name.toUpperCase())+": "+u(n.key),1),t("span",null,u(n.string),1)],8,q))),256)),m.values.length===0?(r(),l("div",O," No results found. ")):w("",!0)])])):w("",!0)]),_:1})]))}};U({components:{"foreign-selection":z}}).mount("#app");
